1 Servo On
2 Ovrd 30
3 '--------------Define palettes------------------
4 M1=5
5 M2=10
6 M3=M1*M2
7 M9=1'count
8 M11 = 3
9 M12 = 7
10 M13 = M11*M12
11 M19 = 1' count
12 Def Plt 1, P1,P2,P3,P4,M1,M2,11
13 Def Plt 2, P11,P12,P13,P14,M11,M12,11
14 P100 = Plt 1, M9
15 P200 = Plt 2, M19
16 Mov PHOME
17 Dly 0.2
18 '------------HAND INIT----------------------
19 HClose 1
20 Dly 1.5
21 HOpen 1
22 Dly 0.7
23 '
24 '--------------------------------------------
25 *LOOP
26 GoSub *VISION
27 GoSub *SEARCH
28 GoSub *PICK
29 GoSub *PLACE
30 M9 = M9+1
31 If M9 <= M3 Then *LOOP
32 Hlt
33 End
34 '
35 '-------------------------------------------
36 *VISION
37 If M_NvOpen(1)<>1 Then
38 NVOpen C_C03$ As #1
39 Wait M_NvOpen(1)=1
40 EndIf
41 NVLoad #1, "Sample2"
42 Dly 0.7
43 Return
44 '
45 '--------------------------------------------
46 *SEARCH
47 *NEKST
48 If M9 > M3 Then
49     Mov PHOME
50     Hlt
51 EndIf
52 P100 = Plt 1, M9
53 Mov P100
54 Dly 2
55 *RETRYS
56 NVRun #1,"sample2.job"
57 EBRead #1,,MNUM,PVS
58 Dly 0.1
59 If MNUM>=1 Then *OKAY
60 MCNT=MCNT+1
61 If MCNT>2 Then
62     M9 = M9+1
63     GoTo *NEKST
64 EndIf
65 Dly 0.2
66 GoTo *RETRYS
67 *OKAY
68 MCNT=1
69 PTRG=P100*P_CMTL*PVS*P_PH03
70 Return
71 '
72 '--------------------------------------------
73 *PICK
74 If M_NvOpen(1)<>1 Then
75 NVOpen C_C03$ As #1
76 Wait M_NvOpen(1)=1
77 EndIf
78 NVLoad #1, "Sample"
79 '-------------------------------------------
80 *NXT
81 If M19 >= M13 Then
82     Mov PHOME
83     Hlt
84 EndIf
85 M19 = M19
86 P200 = Plt 2, M19
87 Mov P200
88 Dly 1.6
89 *RETRY
90 NVRun #1,C_J03$
91 EBRead #1,,MNUM,PVS
92 Dly 0.1
93 If MNUM>=1 Then *OK
94 MCNT=MCNT+1
95 If MCNT>2 Then
96     M19 = M19+1
97     GoTo *NXT
98 EndIf
99 Dly 0.2
100 GoTo *RETRY
101 *OK
102 MCNT=1
103 M19 = M19+1
104 PTRGS=P200*P_CMTL*PVS*P_PH03
105 Mov PTRGS, -100
106 Dly 0.3
107 HOpen 1
108 Dly 0.5
109 Mvs PTRGS,20
110 Dly 0.3
111 HClose 1
112 Dly 0.5
113 HOpen 1
114 Dly 0.5
115 HClose 1
116 Dly 0.5
117 Mov PTRGS, -100
118 '-------------------Error because of absence of item
119 Return
120 '
121 '--------------------------------------------
122 *PLACE
123 Mov PTRG, -150
124 Mov PTRG, -70
125 Mvs PTRG, 20
126 Dly 0.6
127 HOpen 1
128 Dly 0.5
129 Mvs PTRG, -100
130 Return
P1=(+399.76,-276.02,+506.91,+180.00,+0.00,+175.90)(7,0)
P2=(+654.24,-276.02,+506.91,-180.00,+0.00,+175.90)(7,0)
P3=(+654.24,+304.97,+506.91,-180.00,+0.00,+175.90)(7,0)
P4=(+399.76,+304.97,+506.91,+180.00,+0.00,+175.90)(7,0)
P11=(+413.53,+287.41,+506.91,+180.00,+0.00,+175.90)(7,0)
P12=(+413.53,+200.35,+506.91,+180.00,+0.00,+175.90)(7,0)
P13=(+656.21,+200.35,+506.91,+180.00,+0.00,+175.90)(7,0)
P14=(+656.21,+288.07,+506.91,+180.00,+0.00,+175.90)(7,0)
P100=(+569.41,+111.31,+506.91,+180.00,+0.00,+175.90,+0.00,+0.00)(7,0)
P200=(+656.21,+244.21,+506.91,+180.00,+0.00,+175.90,+0.00,+0.00)(7,0)
PHOME=(+269.95,+4.15,+409.26,+180.00,+0.00,+179.25)(7,0)
PVS=(+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00)(0,0)
PTRG=(+521.61,+118.80,+211.47,-180.00,+0.00,-111.21,+0.00,+0.00)(7,0)
P_CMTL=(0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00)(,)
P_PH03=(0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00)(,)
PTRGS=(+464.70,+212.92,+211.47,-180.00,+0.00,+147.65,+0.00,+0.00)(7,0)
