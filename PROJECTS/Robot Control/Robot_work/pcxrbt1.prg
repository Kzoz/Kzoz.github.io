1 Dly 1
2 Servo Off
3 Dly 0.4
4 Dim MDATA(6)
5 M_Out(6010)=0 'X12 off so hex nuts count doesn't move
6 M0 = 1
7 Wait M_In(6013)=1 'Y15 signal sending the values
8 MDATA(1) = M_DIn(6001)
9 MDATA(2) = M_DIn(6002)
10 MDATA(3) = M_DIn(6003)
11 MDATA(4) = M_DIn(6004)
12 MDATA(5) = M_DIn(6005)
13 MDATA(6) = M_DIn(6006)
14 '
15 '
16 *NMOV
17 Dly 0.4
18 Servo On
19 Dly 0.7
20 PPUT=(+627.10,-177.73,+265.88,+178.45,+0.02,-86.19)
21 Def Plt 1, P1,P2,P4,P3,5,2,11
22 M30 = 1
23 MCOUNT = 0
24 Mov Phome
25 '
26 '
27 Dim Mworklist(6)
28 Mworklist(1) = MDATA(1)
29 Mworklist(2) = MDATA(2)
30 Mworklist(3) = MDATA(3)
31 Mworklist(4) = MDATA(4)
32 Mworklist(5) = MDATA(5)
33 Mworklist(6) = MDATA(6)
34 '
35 '
36 Dim PKANAP(5)
37 PKANAP(1) = PKANA1
38 PKANAP(2) = PKANA2
39 PKANAP(3) = PKANA3
40 PKANAP(4) = PKANA4
41 PKANAP(5) = PKANA5
42 '
43 '
44 Dim PKANAU(5)
45 PKANAU(1) = PKANA10
46 PKANAU(2) = PKANA20
47 PKANAU(3) = PKANA30
48 PKANAU(4) = PKANA40
49 PKANAU(5) = PKANA50
50 '
51 '
52 M100 = 1
53 For M10 = 1 To 5' 5 means the length of vector mworklist
54     For M20 = 1 To Mworklist(M10)
55         If M100 = 1 Then
56             If Mworklist(1) > 0 Then
57                 GoSub *ROUTINE
58             EndIf
59         ElseIf M100 = 2 Then
60             If Mworklist(2) > 0 Then
61                 GoSub *ROUTINE
62             EndIf
63         ElseIf M100 = 3 Then
64             If Mworklist(3) > 0 Then
65                 GoSub *ROUTINE
66             EndIf
67         ElseIf M100 = 4 Then
68             If Mworklist(4) > 0 Then
69                 GoSub *ROUTINE
70             EndIf
71         ElseIf M100 = 5 Then
72             If Mworklist(5) > 0 Then
73                 GoSub *ROUTINE
74             EndIf
75         EndIf
76     Next M20
77     M100 = M100+1
78 '
79 Next M10
80 '------------- PKANA6 ƒ{ƒ‹ƒg------------------
81 If Mworklist(6) >=1 Then
82     M_DOut(6001) = Mworklist(6) 'insert in D1
83     Dly 0.2
84     M_Out(6010)=1 'turn on X12
85     Wait M_In(6011)=1 'wait till x13 is on = Hex nut job is done
86     Mov PKANA60
87     HOpen 1
88     Dly 0.3
89     Mvs PKANA6
90     Dly 0.3
91     HClose 1
92     Dly 0.5
93     Cnt 1
94     Mvs P_Curr*(+0.00,+0.00,-40.00,+0.00,+0.00,+0.00)
95     Mov P_Curr*(+0.00,+100.00,+0.00,+0.00,+0.00,+0.00)
96     Mov PPUT*(+0.00,+0.00,-160.00,+0.00,+0.00,+0.00)
97     Mov PPUT*(-40.00,-50.00,-100.00,-75.00,+0.00,-70.00)
98     Dly 1
99     Mov PPUT*(+0.00,+0.00,-160.00,+0.00,+0.00,+0.00)
100     Mov PKANA6*(+0.00,+100.00,-40.00,+0.00,+0.00,+0.00)
101     Mov PKANA6,-40
102     Dly 0.2
103     Mvs PKANA6
104     Cnt 0
105     Dly 0.3
106     HOpen 1
107     Dly 0.5
108     Mvs PKANA60
109 EndIf
110 '--------------------------------------
111 Mov Phome
112 M_Out(6013) = 1
113 End
114 '-------------------------------------------------------------------------
115 *ROUTINE
116 Ovrd 100
117 If M100 = 1 Then GoTo *SPECIALP
118 If M100 = 5 Then GoTo *SPECIALP5
119 '
120 '
121 Dly 0.5
122 Mov PKANAU(M100)
123 Dly 0.3
124 HOpen 1
125 Dly 0.3
126 Mov PKANAP(M100)
127 Dly 0.3
128 HClose 1
129 Dly 0.5
130 If M100 = 4 Then
131     Mov P_Curr*(+17.00,+0.00,+0.00,+0.00,+0.00,+0.00)
132     Cnt 1
133     Mov P_Curr*(+0.00,+0.00,-110.00,+0.00,+0.00,+0.00)
134     Mov PKANA41
135     Cnt 0
136 Else
137     Mov P_Curr*(+0.00,-30.00,-7.00,+0.00,+0.00,+0.00)
138     Mov P_Curr*(+0.00,+0.00,-70.00,+0.00,+0.00,+0.00)
139 EndIf
140 Cnt 1
141 Mov PTRANSIT2
142 Mov PPUT,-120
143 Cnt 0
144 '
145 '
146 *COMEBACK
147 If M100 = 1 Then
148     P100 = Plt 1, M30
149     If M30 >= 6 Then
150         Mov P100*(-4.50,-20.00,+0.00,+0.00,+0.00,+180.00)
151     Else
152         Mov P100
153     EndIf
154     Dly 0.4
155     Mov P_Curr*(+0.00,+0.00,+99.00,+0.00,+0.00,+0.00)
156     Dly 0.7
157     HOpen 1
158     Dly 0.3
159     Mov P_Curr*(+0.00,+0.00,-99.00,+0.00,+0.00,+0.00)
160     If M30 >= 10 Then Hlt 'P1 to P4 z+120 and M30 =0
161     M30 = M30+1
162     GoTo *JUMP
163 EndIf
164 Ovrd 20
165 Mvs PPUT
166 Dly 0.5
167 HOpen 1
168 Dly 0.3
169 Mov P_Curr*(+0.00,+0.00,-100.00,+0.00,+0.00,+0.00)
170 MCOUNT = MCOUNT+1
171 If MCOUNT = 5 Then
172     PPUT=(+667.10,-177.73,+265.88,+178.45,+0.02,-86.19)
173 ElseIf MCOUNT = 10 Then
174     MCOUNT = 0
175     PPUT=(+707.10,-177.73,+265.88,+178.45,+0.02,-86.19)
176 Else
177     PPUT = PPUT*(-33.00,+0.00,+0.00,+0.00,+0.00,+0.00)
178 EndIf
179 *JUMP
180 Mov PTRANSIT
181 Return
182 '
183 *SPECIALP
184 *SPECIALP5
185 Mov PKANAU(M100)
186 Dly 0.5
187 HOpen 1
188 Dly 0.3
189 Mvs PKANAP(M100)
190 Dly 0.5
191 HClose 1
192 Dly 0.5
193 PTPUT = PPUT*(+0.00,+0.00,-120.00,+0.00,+0.00,+0.00)
194 Mvr PKANAU(M100),PTRANSIT2,PTPUT
195 GoTo *COMEBACK
PPUT=(+624.91,-144.80,+265.89,+178.45,+0.02,-86.19)(7,0)
P1=(+622.47,-220.63,+283.70,+178.45,+0.02,-92.37)(7,0)
P2=(+622.47,-22.36,+283.70,+178.45,+0.02,-92.37)(7,0)
P4=(+682.50,-22.36,+283.70,+178.45,+0.02,-92.37)(7,0)
P3=(+682.50,-220.63,+283.70,+178.45,+0.02,-92.37)(7,0)
Phome=(+251.72,+4.35,+379.47,+176.90,+2.01,-89.86)(7,0)
PKANAP(1)=(+473.22,+593.28,+382.10,+179.66,+16.92,-91.25,+0.00,+0.00)(7,0)
PKANAP(2)=(+327.62,+468.48,+217.21,-80.31,+6.68,+0.62,+0.00,+0.00)(6,0)
PKANAP(3)=(+103.64,+463.60,+234.57,-84.39,+7.10,-1.46,+0.00,+0.00)(6,0)
PKANAP(4)=(-65.17,+514.42,+278.04,+12.62,-84.88,-104.60,+0.00,+0.00)(6,15728640)
PKANAP(5)=(+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00)(0,0)
PKANA1=(+473.22,+593.28,+382.10,+179.66,+16.92,-91.25)(7,0)
PKANA2=(+327.62,+468.48,+217.21,-80.31,+6.68,+0.62)(6,0)
PKANA3=(+103.64,+463.60,+234.57,-84.39,+7.10,-1.46)(6,0)
PKANA4=(-65.17,+514.42,+278.04,+12.62,-84.88,-104.60)(6,15728640)
PKANA5=(+458.58,+654.91,+574.90,-171.42,+17.56,-87.42)(7,0)
PKANAU(1)=(+473.22,+559.61,+503.78,+179.66,+16.92,-91.25,+0.00,+0.00)(7,0)
PKANAU(2)=(+327.62,+316.10,+190.27,-80.31,+6.68,+0.62,+0.00,+0.00)(6,0)
PKANAU(3)=(+102.92,+362.47,+218.60,-84.42,+7.11,-1.47,+0.00,+0.00)(6,0)
PKANAU(4)=(-61.26,+372.88,+247.43,+12.56,-84.88,-104.54,+0.00,+0.00)(6,15728640)
PKANAU(5)=(+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00,+0.00)(0,0)
PKANA10=(+473.22,+559.61,+503.78,+179.66,+16.92,-91.25)(7,0)
PKANA20=(+327.62,+316.10,+190.27,-80.31,+6.68,+0.62)(6,0)
PKANA30=(+102.92,+362.47,+218.60,-84.42,+7.11,-1.47)(6,0)
PKANA40=(-61.26,+372.88,+247.43,+12.56,-84.88,-104.54)(6,15728640)
PKANA50=(+448.96,+614.63,+698.32,-169.98,+19.21,-86.97)(7,0)
PKANA60=(+640.13,+569.00,+408.28,-178.96,-1.62,-2.31)(7,0)
PKANA6=(+640.13,+569.00,+295.41,-178.96,-1.62,-2.31)(7,0)
PKANA41=(+108.16,+297.29,+509.86,-13.02,-50.75,-107.62)(6,15728640)
PTRANSIT2=(+465.97,-81.88,+438.88,-178.71,-0.20,+158.58)(7,0)
P100=(+682.50,-121.50,+283.70,+178.45,+0.02,-92.37,+0.00,+0.00)(7,0)
PTRANSIT=(+385.62,+17.44,+433.79,+178.45,+0.02,-86.19)(7,0)
PTPUT=(+630.34,-177.56,+385.84,+178.45,+0.02,-86.19,+0.00,+0.00)(7,0)
